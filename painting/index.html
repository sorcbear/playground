<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>paper pickup</title>

  <!-- 预加载，避免慢网不顺 -->
  <link rel="preload" as="image" href="p1.png">
  <link rel="preload" as="image" href="p2.png">

  <style>
    :root{
      --maxw: 980px;
      --pad: 18px;
    }

    html,body{
      margin:0;
      background:#fff;
      font-family:-apple-system,BlinkMacSystemFont,
        "PingFang SC","Microsoft YaHei",Arial,sans-serif;
    }

    .wrap{
      max-width:var(--maxw);
      margin:0 auto;
      padding:var(--pad);
      box-sizing:border-box;
    }

    /* ===== 顶部画板 ===== */
    .stage{
      position:relative;
      max-width:1024px;
      margin:0 auto;
      user-select:none;
    }

    /* 固定比例：765 / 1024 */
    .stage::before{
      content:"";
      display:block;
      padding-top:74.70703125%;
    }

    .layer{
      position:absolute;
      inset:0;
    }

    .layer img{
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
      pointer-events:none;
    }

    /* ===== 关键：用 opacity，不用 display ===== */
    .imgA, .imgB{
      position:absolute;
      inset:0;
      opacity:0;
      transition:none;
    }

    .imgA{ opacity:1; }

    .revealed .imgA{ opacity:0; }
    .revealed .imgB{ opacity:1; }

    /* ===== p0 纸卷热点（按新图校准） ===== */
    .hotspot{
      position:absolute;
      left:12.79%;
      top:71.24%;
      width:21.48%;
      height:12.42%;
      border:0;
      background:transparent;
      cursor:pointer;
      padding:0;
    }

    .hotspot:disabled{
      pointer-events:none;
      cursor:default;
    }

    /* ===== p2：初始隐藏 ===== */
    .pickup{
      display:none;
      max-width:1024px;
      margin:18px auto 0;
    }

    .revealed ~ .pickup{
      display:block;
    }

    .p2box{
      position:relative;
    }

    .p2box img{
      width:100%;
      height:auto;
      display:block;
    }

    .p2btn{
      position:absolute;
      inset:0;
      border:0;
      background:transparent;
      cursor:pointer;
    }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="stage" id="stage">
      <div class="layer imgA">
        <img src="p0.png" alt="">
      </div>
      <div class="layer imgB">
        <img src="p1.png" alt="">
      </div>

      <button class="hotspot" id="hotspot" disabled></button>
    </div>

    <div class="pickup">
      <div class="p2box">
        <img src="p2.png" alt="">
        <button class="p2btn" id="p2btn"></button>
      </div>
    </div>

  </div>

  <script>
    (function(){
      const stage = document.getElementById("stage");
      const rollBtn = document.getElementById("hotspot");
      const p2Btn = document.getElementById("p2btn");

      const NEXT = "https://sorcbear.github.io/playground/paper";

      let ready1 = false;
      let ready2 = false;

      function sync(){
        rollBtn.disabled = !(ready1 && ready2);
      }

      function preload(src, cb){
        const i = new Image();
        i.onload = cb;
        i.src = src;
      }

      preload("p1.png", ()=>{ ready1=true; sync(); });
      preload("p2.png", ()=>{ ready2=true; sync(); });

      rollBtn.addEventListener("click", ()=>{
        stage.classList.add("revealed");
      });

      p2Btn.addEventListener("click", ()=>{
        location.href = NEXT;
      });
    })();
  </script>
</body>
</html>
