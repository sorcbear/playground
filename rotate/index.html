<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- 禁止 iOS Safari 自动识别地址/电话/邮箱 -->
<meta name="format-detection" content="telephone=no,address=no,email=no">

<title>Rotate</title>

<style>
:root{
  --maxw: 720px;

  --fs-body: 16px;
  --lh-body: 1.7;

  --fs-hint: 18px;
  --lh-hint: 1.6;

  --fs-btn: 16px;
  --fw-btn: 600;
  --h-btn: 52px;

  --c-text:#111;
  --c-border:#000;
  --c-ok:#0b6b2b;
  --c-danger:#b00020;
}

html,body{
  margin:0;
  background:#fff;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,
               "PingFang SC","Microsoft YaHei",Arial,sans-serif;
  font-size:var(--fs-body);
  line-height:var(--lh-body);
  color:var(--c-text);
}

.wrap{
  max-width:var(--maxw);
  margin:0 auto;
  padding:18px 14px 28px;
  box-sizing:border-box;
}

/* ===== 标题样式（基准） ===== */
.title{
  margin:0 0 18px 0;
  font-size:var(--fs-hint);
  line-height:var(--lh-hint);
  font-weight:700;
  white-space:pre-wrap;
}

/* ===== 正确地址行 ===== */
.answerRow{
  margin-top:18px;
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
}

/* 文本：与标题完全一致 */
.fixedWord{
  font-size:var(--fs-hint);
  line-height:var(--lh-hint);
  font-weight:700;
}

/* ===== 输入框（彻底无高亮） ===== */
.ansInput{
  width:4.2em;
  height:40px;
  padding:0 8px;
  border:2px solid var(--c-border);
  border-radius:0;
  font-size:16px;
  line-height:40px;
  text-align:center;
  box-sizing:border-box;

  outline:none;
  box-shadow:none;
  -webkit-appearance:none;
  -webkit-tap-highlight-color:transparent;
}
.ansInput:focus{
  outline:none;
  box-shadow:none;
}

/* ===== 按钮区 ===== */
.panel{
  margin-top:56px;
  display:flex;
  justify-content:center;
  gap:12px;
  flex-wrap:nowrap;
}

/* 按钮基础样式（Square / Circle 统一） */
button{
  width:240px;
  height:var(--h-btn);
  padding:0 18px;
  box-sizing:border-box;

  font-size:var(--fs-btn);
  font-weight:600;

  background:#fff;
  color:#000;
  border:2px solid var(--c-border);
  border-radius:0;

  cursor:pointer;
  user-select:none;
  -webkit-tap-highlight-color:transparent;
}

/* PC hover */
@media (hover:hover) and (pointer:fine){
  button:hover{
    background:#000;
    color:#fff;
  }
}

/* JS 控制的瞬时反转 */
button.invert{
  background:#000;
  color:#fff;
}

button:disabled{
  opacity:.45;
  cursor:default;
}

/* 提示文案 */
.msg{
  margin-top:12px;
  min-height:1.4em;
  font-size:14px;
}
.msg.ok{ color:var(--c-ok); }

@media (max-width:520px){
  button{ width:46vw; }
}
</style>
</head>

<body>
<div class="wrap">

  <div class="title">
点击拼图方块，完成拼图。然后输入正确的起点地址并提交答案。这就是一切的起点。（可横屏操作）
  </div>

  <!-- 这里省略拼图区域，与原 rotate 保持不变 -->

  <div class="answerRow">
    <span class="fixedWord">正确地址：</span>
    <input id="ansRoad" class="ansInput" autocomplete="off" />
    <span class="fixedWord">路</span>
    <input id="ansNo" class="ansInput" inputmode="numeric" autocomplete="off" />
    <span class="fixedWord">号</span>
  </div>

  <div class="panel">
    <button id="hintBtn">获得提示</button>
    <button id="submitBtn">提交答案</button>
  </div>

  <div class="msg" id="msg"></div>

</div>

<script>
const ANSWER_ROAD = "天平";
const ANSWER_NO   = "41";

const HINT_URL = "../rotate/hint/";
const NEXT_URL = "../circle/";
const COUNTDOWN_START = 3;

const ansRoad = document.getElementById("ansRoad");
const ansNo   = document.getElementById("ansNo");
const submitBtn = document.getElementById("submitBtn");
const hintBtn   = document.getElementById("hintBtn");
const msg = document.getElementById("msg");

let locked=false;
let countdownTimer=null;
let btnTimer=null;

/* 短暂黑底白字 */
function flashInvert(btn, ms=120){
  btn.classList.add("invert");
  setTimeout(()=>btn.classList.remove("invert"), ms);
}

/* 错误按钮反馈（Square 同款） */
function showSubmitError(text="不正确，再试一次", ms=900){
  if (btnTimer) clearTimeout(btnTimer);

  submitBtn.textContent = text;
  submitBtn.classList.add("invert");
  submitBtn.disabled = true;

  btnTimer = setTimeout(()=>{
    submitBtn.textContent = "提交答案";
    submitBtn.classList.remove("invert");
    submitBtn.disabled = false;
    btnTimer=null;
  }, ms);
}

/* 获得提示 */
hintBtn.onclick = ()=>{
  if (locked) return;
  flashInvert(hintBtn,120);
  setTimeout(()=>location.href=HINT_URL,120);
};

/* 提交答案 */
submitBtn.onclick = ()=>{
  if (locked) return;

  const ok =
    ansRoad.value.trim() === ANSWER_ROAD &&
    ansNo.value.trim() === ANSWER_NO;

  if (!ok){
    msg.textContent="";
    msg.classList.remove("ok");
    showSubmitError("不正确，再试一次",900);
    return;
  }

  locked=true;
  submitBtn.disabled=true;
  hintBtn.disabled=true;
  ansRoad.disabled=true;
  ansNo.disabled=true;

  let t=COUNTDOWN_START;
  msg.textContent=`答案正确，即将进入下一题（${t}）`;
  msg.classList.add("ok");

  countdownTimer=setInterval(()=>{
    t--;
    if(t>0){
      msg.textContent=`答案正确，即将进入下一题（${t}）`;
    }else{
      clearInterval(countdownTimer);
      location.href=NEXT_URL;
    }
  },1000);
};
</script>

</body>
</html>
