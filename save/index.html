<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Save</title>

  <style>
    :root{
      --maxw: 720px;

      --fs-body: 18px;
      --lh-body: 1.7;

      --btn-h: 52px;

      --gap: 18px;

      --c-text:#111;
      --c-border:#000;
      --bg:#fff;

      /* 轨道参数 */
      --rail-w: 4px;
      --dot: 12px;
      --rail-left: 22px; /* 轨道相对卡片左侧位置 */
    }

    *{ box-sizing:border-box; }

    html,body{
      margin:0;
      padding:0;
      width:100%;
      min-height:100%;
      background:var(--bg);
      color:var(--c-text);
      font-family: system-ui, -apple-system, "PingFang SC","Microsoft YaHei", Arial, sans-serif;
      font-size:var(--fs-body);
      line-height:var(--lh-body);
    }

    .wrap{
      max-width:var(--maxw);
      margin:0 auto;
      padding:24px 16px 40px;
    }

    .card{
      width:100%;
      margin:0 auto;
      padding:18px 14px;
      border:2px solid var(--c-border);
      background:#fff;
    }

    /* 轨道容器 NOTICE：左侧给轨道留空间 */
    .rail{
      position:relative;
      padding-left:56px;
    }

    /* 主竖线 */
    .rail::before{
      content:"";
      position:absolute;
      left:var(--rail-left);
      top:10px;
      bottom:10px;
      width:var(--rail-w);
      background:var(--c-border);
    }

    /* 单个 step：圆点 + 按钮 */
    .step{
      position:relative;
      display:flex;
      align-items:center;
      gap:14px;
      padding:14px 0;
    }

    /* 圆点：路线节点（独立于按钮） */
    .dot{
      position:absolute;
      left:calc(var(--rail-left) - (var(--dot) / 2) + (var(--rail-w) / 2));
      width:var(--dot);
      height:var(--dot);
      border:2px solid var(--c-border);
      background:#fff;
      border-radius:999px;
    }

    /* 按钮：自适应宽度，视觉更接近你图里的“长条但不夸张” */
    .btn{
      height:var(--btn-h);
      padding:0 18px;

      display:inline-flex;
      align-items:center;
      justify-content:flex-start;
      gap:12px;

      font-size:var(--fs-body);
      font-weight:600;

      background:#fff;
      color:#000;
      border:2px solid var(--c-border);
      cursor:pointer;
      border-radius:0;

      -webkit-tap-highlight-color: transparent;
      user-select:none;
      white-space:nowrap; /* 保证不换行 */
    }
    .btn:hover{ background:#000; color:#fff; }
    .btn:disabled{ opacity:.45; cursor:default; }

    /* 图标 */
    .ico{
      width:28px;
      height:28px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      flex:0 0 auto;
    }
    .ico svg{ width:100%; height:100%; display:block; }

    /* 文字 */
    .label{
      display:inline-block;
      line-height:1;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="rail" id="rail"></div>
    </div>
  </div>

  <script>
    // ====== 存档 key（写入一次后永久显示）======
    const K_UNLOCK_CIRCLE = "pg_unlock_circle_v1"; // rotate 正确后解锁：天平路（circle）
    const K_UNLOCK_SQUARE = "pg_unlock_square_v1"; // address 正确后解锁：康平路（square）
    const K_UNLOCK_PPL    = "pg_unlock_ppl_v1";    // post 正确后解锁：衡山路（ppl）

    const STEP = [
      { id:"start",  text:"起点",   url:"https://sorcbear.github.io/playground/rotate",  needKey:null,            icon: svgStart },
      { id:"circle", text:"天平路", url:"https://sorcbear.github.io/playground/circle",  needKey:K_UNLOCK_CIRCLE, icon: svgBlueSquare },
      { id:"square", text:"康平路", url:"https://sorcbear.github.io/playground/square",  needKey:K_UNLOCK_SQUARE, icon: svgGreenCircle },
      { id:"ppl",    text:"衡山路", url:"https://sorcbear.github.io/playground/ppl",     needKey:K_UNLOCK_PPL,    icon: svgRedDiamond },
    ];

    function safeGet(key){
      try { return window.localStorage.getItem(key); } catch(e){ return null; }
    }

    function isUnlocked(needKey){
      if (!needKey) return true;      // 起点永远显示
      return !!safeGet(needKey);      // 写过就显示
    }

    // ====== 4 个彩色矢量图标 ======
    // 起点：黄色（“吃豆人”）
    function svgStart(){
      return `
        <svg viewBox="0 0 64 64" aria-hidden="true">
          <path d="M32 6a26 26 0 1 0 0 52a26 26 0 0 0 0-52Z" fill="#F6B300"/>
          <path d="M32 32L58 18v28L32 32Z" fill="#fff"/>
        </svg>
      `;
    }

    // 天平路：蓝色方块
    function svgBlueSquare(){
      return `
        <svg viewBox="0 0 64 64" aria-hidden="true">
          <rect x="10" y="10" width="44" height="44" fill="#1E73D8"/>
        </svg>
      `;
    }

    // 康平路：绿色圆形
    function svgGreenCircle(){
      return `
        <svg viewBox="0 0 64 64" aria-hidden="true">
          <circle cx="32" cy="32" r="22" fill="#2E7D32"/>
        </svg>
      `;
    }

    // 衡山路：红色菱形（如需换成你指定红色矢量，替换此函数即可）
    function svgRedDiamond(){
      return `
        <svg viewBox="0 0 64 64" aria-hidden="true">
          <path d="M32 8L56 32 32 56 8 32 32 8Z" fill="#D32F2F"/>
        </svg>
      `;
    }

    function makeBtn(iconSVG, text, url){
      const btn = document.createElement("button");
      btn.className = "btn";
      btn.type = "button";
      btn.innerHTML = `
        <span class="ico">${iconSVG}</span>
        <span class="label">${text}</span>
      `;
      btn.onclick = () => { location.href = url; };
      return btn;
    }

    function addStep(railEl, iconSVG, text, url){
      const row = document.createElement("div");
      row.className = "step";

      const dot = document.createElement("span");
      dot.className = "dot";
      row.appendChild(dot);

      row.appendChild(makeBtn(iconSVG, text, url));
      railEl.appendChild(row);
    }

    function render(){
      const rail = document.getElementById("rail");
      rail.innerHTML = "";

      for (const s of STEP){
        if (isUnlocked(s.needKey)){
          addStep(rail, s.icon(), s.text, s.url);
        }
      }
    }

    render();

    // ======（可选）调试：加 ?reset=1 清空存档 ======
    // if (new URLSearchParams(location.search).get("reset") === "1") {
    //   localStorage.removeItem(K_UNLOCK_CIRCLE);
    //   localStorage.removeItem(K_UNLOCK_SQUARE);
    //   localStorage.removeItem(K_UNLOCK_PPL);
    //   location.replace(location.pathname);
    // }
  </script>
</body>
</html>
