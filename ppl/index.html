<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ppl</title>

<style>
:root{
  --c-blue:#0070c0;
  --c-cyan:#00b0f0;
  --c-green:#00b050;
  --c-lgreen:#92d050;
  --c-yellow:#ffff00;
  --c-orange:#ffc000;
  --c-red:#ff0000;
  --c-purple:#7030a0;

  --maxw:980px;

  --fs-body:16px;
  --lh-body:1.7;

  --fs-title:18px;
  --lh-title:1.6;

  --fs-btn:16px;
  --fw-btn:600;
  --h-btn:52px;

  --c-text:#111;
  --c-border:#000;
  --c-ok:#0b6b2b;
  --c-danger:#b00020;
}

html,body{
  margin:0;
  background:#fff;
  font-family:"Microsoft YaHei","PingFang SC","Noto Sans SC",sans-serif;
  font-size:var(--fs-body);
  line-height:var(--lh-body);
  color:var(--c-text);
}

.wrap{
  max-width:var(--maxw);
  margin:0 auto;
  padding:24px 16px 40px;
  box-sizing:border-box;
}

/* ===== title 样式 ===== */
.title{
  margin:0 0 12px 0;
  font-size:var(--fs-title);
  line-height:var(--lh-title);
  font-weight:700;
}

/* 图片 */
img{
  width:100%;
  display:block;
  margin:0;
}

/* ===== 输入区 ===== */
.code{ margin-top:18px; }

.slots{
  margin-top:12px;
  display:flex;
  align-items:center;
  flex-wrap:wrap;
  gap:8px;
  margin-bottom:36px; /* 与按钮之间多隔一行 */
}

/* ===== 单行 input：真正垂直居中 ===== */
.slot{
  height:40px;
  line-height:40px;          /* ✅ input 垂直居中关键 */
  border:2px solid var(--c-border);
  font-size:var(--fs-title);
  font-weight:700;
  font-family:inherit;
  text-align:center;
  padding:0 6px;             /* 左右内边距，不影响垂直居中 */
  box-sizing:border-box;
  outline:none;
  caret-color:#000;
  border-radius:0;
  -webkit-appearance:none;
}

/* 防止 iOS 乱加阴影/圆角 */
.slot:focus{ outline:none; box-shadow:none; }

/* 宽度 */
.w1{ width:50px; }
.w2{ width:84px; }

/* 固定字：路（与 title 完全一致） */
.fixedWord{
  height:46px;
  line-height:46px;
  font-size:var(--fs-title);
  font-weight:700;
  font-family:inherit;
  color:#111;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0 6px;
  box-sizing:border-box;
  user-select:none;
}

/* ===== Square 风格按钮 ===== */
.panel{
  margin-top:36px;
  display:flex;
  gap:12px;
  justify-content:center;
  flex-wrap:nowrap;
}

button{
  width:240px;
  height:var(--h-btn);
  padding:0 18px;
  box-sizing:border-box;
  font-size:var(--fs-btn);
  font-weight:var(--fw-btn);
  background:#fff;
  color:#000;
  border:2px solid var(--c-border);
  cursor:pointer;
  border-radius:0;
  -webkit-tap-highlight-color:transparent;
}

@media (hover:hover) and (pointer:fine){
  button:hover{ background:#000; color:#fff; }
}

button.invert{
  background:#000;
  color:#fff;
}

button:disabled{
  opacity:.45;
  cursor:default;
}

/* msg */
.msg{
  margin-top:12px;
  min-height:1.4em;
  font-size:14px;
  line-height:1.6;
}
.msg.ok{
  color:var(--c-ok);
  font-weight:700;
}

@media (max-width:520px){
  button{ width:46vw; }
}
</style>
</head>

<body>
<div class="wrap">

  <p class="title">
    原来是那一天，记得参加完签售会后，我去了衡山公园约会，那里有一个名人雕塑，或许有下一个谜题的线索。
  </p>

  <img src="puzzle.png" alt="puzzle">

  <div class="code">
    <div class="title">请在彩色方框内输入暗号：</div>

    <div class="slots">
      <input id="s1" class="slot w1" style="background:var(--c-blue)"  inputmode="text" autocomplete="off" />
      <input id="s2" class="slot w2" style="background:var(--c-cyan)"  inputmode="text" autocomplete="off" />
      <input id="s3" class="slot w1" style="background:var(--c-green)" inputmode="text" autocomplete="off" />
      <input id="s4" class="slot w2" style="background:var(--c-lgreen)" inputmode="text" autocomplete="off" />

      <div class="fixedWord">路</div>

      <input id="s5" class="slot w1" style="background:var(--c-yellow)" inputmode="text" autocomplete="off" />
      <input id="s6" class="slot w1" style="background:var(--c-orange)" inputmode="text" autocomplete="off" />
      <input id="s7" class="slot w1" style="background:var(--c-red)"    inputmode="text" autocomplete="off" />
      <input id="s8" class="slot w1" style="background:var(--c-purple)" inputmode="text" autocomplete="off" />
    </div>
  </div>

  <div class="panel">
    <button id="hintBtn">获得提示</button>
    <button id="submitBtn">提交答案</button>
  </div>

  <div id="msg" class="msg"></div>
</div>

<script>
const ANSWER = ["四","君子","在","衡山","五","四","三","号"];
const ids = ["s1","s2","s3","s4","s5","s6","s7","s8"];

const HINT_URL = "https://sorcbear.github.io/playground/ppl/hint";
const NEXT_URL = "https://sorcbear.github.io/playground/riddle/";
const COUNTDOWN_START = 3;

const hintBtn = document.getElementById("hintBtn");
const submitBtn = document.getElementById("submitBtn");
const msg = document.getElementById("msg");

let locked = false;
let timer = null;
let btnTimer = null;

function clean(v){
  return (v || "").replace(/\s/g,"");
}

function flashInvert(btn, ms=120){
  btn.classList.add("invert");
  setTimeout(()=>btn.classList.remove("invert"), ms);
}

function setLocked(v){
  locked = v;
  hintBtn.disabled = v;
  submitBtn.disabled = v;
  ids.forEach(id=>{
    const el = document.getElementById(id);
    if(el) el.disabled = v;
  });
}

function setBtnText(text, ms=900){
  if(btnTimer){ clearTimeout(btnTimer); btnTimer=null; }
  submitBtn.textContent = text;
  submitBtn.classList.add("invert");
  submitBtn.disabled = true;

  btnTimer = setTimeout(()=>{
    submitBtn.textContent = "提交答案";
    submitBtn.classList.remove("invert");
    submitBtn.disabled = false;
    btnTimer = null;
  }, ms);
}

hintBtn.onclick = ()=>{
  if(locked) return;
  flashInvert(hintBtn,120);
  setTimeout(()=>location.href = HINT_URL,120);
};

function isCorrect(){
  return ids.every((id,i)=> clean(document.getElementById(id).value) === ANSWER[i]);
}

submitBtn.onclick = ()=>{
  if(locked) return;

  if(isCorrect()){
    setLocked(true);
    let t = COUNTDOWN_START;
    msg.textContent = `答案正确，即将进入下一题（${t}）`;
    msg.classList.add("ok");

    if(timer) clearInterval(timer);
    timer = setInterval(()=>{
      t--;
      if(t > 0){
        msg.textContent = `答案正确，即将进入下一题（${t}）`;
      }else{
        clearInterval(timer);
        location.href = NEXT_URL;
      }
    },1000);

  }else{
    msg.textContent = "";
    msg.classList.remove("ok");
    setBtnText("不正确，再试一次",900);
  }
};
</script>
</body>
</html>
