<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Secret Puzzle</title>

<style>
:root{
  --c-blue:#0070c0;
  --c-cyan:#00b0f0;
  --c-green:#00b050;
  --c-lgreen:#92d050;
  --c-yellow:#ffff00;
  --c-orange:#ffc000;
  --c-red:#ff0000;
  --c-purple:#7030a0;

  /* ✅ 同源：Rotate */
  --maxw:720px;

  --fs-body:18px;
  --lh-body:1.6;

  /* 这里保留你原变量名，但值同源 */
  --fs-title:18px;
  --lh-title:1.6;

  --fs-btn:18px;
  --fw-btn:600;
  --h-btn:52px;

  /* ✅ 同源间距体系 */
  --gap:18px;
  --gap-tight:12px;

  --c-text:#111;
  --c-border:#000;
  --c-ok:#0b6b2b;
  --c-danger:#b00020;

  --bg:#fff;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  margin:0;
  background:var(--bg);
  color:var(--c-text);

  /* ✅ 同源：Rotate 字体栈 */
  font-family: system-ui, -apple-system, "PingFang SC","Microsoft YaHei", Arial, sans-serif;

  font-size:var(--fs-body);
  line-height:var(--lh-body);

  /* ✅ 同源：Rotate */
  -webkit-text-size-adjust:100%;
}

.wrap{
  max-width:var(--maxw);
  margin:0 auto;

  /* ✅ 同源：Rotate padding */
  padding:18px 14px 28px;
}

/* ===== title 样式：✅ 同源 titleLine 规范 ===== */
.title{
  margin:4px 0 var(--gap);
  font-size:var(--fs-title);
  line-height:var(--lh-title);
  font-weight:700;
  text-align:left;
  white-space:pre-wrap;
}

/* ✅ 插入图片：行内图标（大小/间距跟文字自然一致） */
.inlineIcon{
  height:1em;
  width:auto;
  display:inline-block;
  vertical-align:-0.12em;
  margin:0 .18em;
}

/* 图片（仅主图） */
.puzzleImg{
  width:100%;
  display:block;
  margin:0;
}

/* ===== 输入区 ===== */
.code{ margin-top:var(--gap); }

.slots{
  margin-top:var(--gap-tight);
  display:flex;
  align-items:center;
  flex-wrap:wrap;
  gap:8px;

  /* ✅ 原 36px → 同源表达（两行） */
  margin-bottom:calc(var(--gap) * 2);
}

/* ===== 单行 input：真正垂直居中 ===== */
.slot{
  height:40px;
  line-height:40px;
  border:2px solid var(--c-border);
  font-size:var(--fs-title);
  font-weight:700;
  font-family:inherit;
  text-align:center;
  padding:0 6px;
  outline:none;
  caret-color:#000;
  border-radius:0;
  -webkit-appearance:none;
  box-shadow:none;
}
.slot:focus{ outline:none; box-shadow:none; }

/* 宽度 */
.w1{ width:50px; }
.w2{ width:84px; }

/* 固定字：路（与 title 完全一致） */
.fixedWord{
  height:40px;
  line-height:40px;
  font-size:var(--fs-title);
  font-weight:700;
  font-family:inherit;
  color:#111;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0 6px;
  user-select:none;
}

/* ===== Square 风格按钮 ===== */
.panel{
  margin-top:var(--gap);
  display:flex;
  gap:12px;
  justify-content:center;
  flex-wrap:nowrap;
}

button{
  width:240px;
  height:var(--h-btn);
  padding:0 18px;
  box-sizing:border-box;
  font-size:var(--fs-btn);
  font-weight:var(--fw-btn);
  background:#fff;
  color:#000;
  border:2px solid var(--c-border);
  cursor:pointer;
  border-radius:0;
  -webkit-tap-highlight-color:transparent;
  font-family:inherit;
  transition:none;
}

@media (hover:hover) and (pointer:fine){
  button:hover{ background:#000; color:#fff; }
}

button.invert{
  background:#000;
  color:#fff;
}

button:disabled{
  opacity:.45;
  cursor:default;
}

/* msg */
.msg{
  margin-top:var(--gap-tight);
  min-height:1.4em;
  font-size:14px;
  line-height:1.6;
}
.msg.ok{
  color:var(--c-ok);
  font-weight:700;
}

@media (max-width:520px){
  button{ width:46vw; }
}
</style>
</head>

<body>
<div class="wrap">
<div class="title"><span style="color:#1E88E5">刚才你找到的第一个蓝色方块，是一家超市，时间还长，可以先买瓶水喝。</span>找到衡山公园里“<img class="inlineIcon" src="icon.png" alt="marker">”指向的地点，寻找线索。</div>
<img class="puzzleImg" src="puzzle.png" alt="puzzle">
<div class="code">
<div class="title" style="margin:0 0 var(--gap-tight);">请在彩色方框内输入暗号：</div>
<div class="slots">
<input id="s1" class="slot w1" style="background:var(--c-blue)" inputmode="text" autocomplete="off" />
<input id="s2" class="slot w2" style="background:var(--c-cyan)" inputmode="text" autocomplete="off" />
<input id="s3" class="slot w1" style="background:var(--c-green)" inputmode="text" autocomplete="off" />
<input id="s4" class="slot w2" style="background:var(--c-lgreen)" inputmode="text" autocomplete="off" />
<div class="fixedWord">路</div>
<input id="s5" class="slot w1" style="background:var(--c-yellow)" inputmode="text" autocomplete="off" />
<input id="s6" class="slot w1" style="background:var(--c-red)" inputmode="text" autocomplete="off" />
<input id="s7" class="slot w1" style="background:var(--c-orange)" inputmode="text" autocomplete="off" />
<input id="s8" class="slot w1" style="background:var(--c-purple)" inputmode="text" autocomplete="off" />
</div>
</div>
<div class="panel">
<button id="hintBtn">获得提示</button>
<button id="submitBtn">提交答案</button>
</div>
<div id="msg" class="msg"></div>
</div>

<script>
const ANSWER=["四","君子","在","衡山","五","三","四","号"];
const ids=["s1","s2","s3","s4","s5","s6","s7","s8"];

const HINT_URL="https://sorcbear.github.io/playground/ppl/hint";
const NEXT_URL="https://sorcbear.github.io/playground/riddle/";
const COUNTDOWN_START=3;

const hintBtn=document.getElementById("hintBtn");
const submitBtn=document.getElementById("submitBtn");
const msg=document.getElementById("msg");

let locked=false;
let timer=null;
let btnTimer=null;

function clean(v){
return (v||"").replace(/\s/g,"");
}

function flashInvert(btn,ms=120){
btn.classList.add("invert");
setTimeout(()=>btn.classList.remove("invert"),ms);
}

function setLocked(v){
locked=v;
hintBtn.disabled=v;
submitBtn.disabled=v;
ids.forEach(id=>{
const el=document.getElementById(id);
if(el) el.disabled=v;
});
}

function setBtnText(text,ms=900){
if(btnTimer){ clearTimeout(btnTimer); btnTimer=null; }
submitBtn.textContent=text;
submitBtn.classList.add("invert");
submitBtn.disabled=true;

btnTimer=setTimeout(()=>{
submitBtn.textContent="提交答案";
submitBtn.classList.remove("invert");
submitBtn.disabled=false;
btnTimer=null;
},ms);
}

hintBtn.onclick=()=>{
if(locked) return;
flashInvert(hintBtn,120);
setTimeout(()=>location.href=HINT_URL,120);
};

function isCorrect(){
return ids.every((id,i)=> clean(document.getElementById(id).value)===ANSWER[i]);
}

submitBtn.onclick=()=>{
if(locked) return;

if(isCorrect()){
setLocked(true);
let t=COUNTDOWN_START;
msg.textContent=`答案正确，即将进入下一题（${t}）`;
msg.classList.add("ok");

if(timer) clearInterval(timer);
timer=setInterval(()=>{
t--;
if(t>0){
msg.textContent=`答案正确，即将进入下一题（${t}）`;
}else{
clearInterval(timer);
location.href=NEXT_URL;
}
},1000);

}else{
msg.textContent="";
msg.classList.remove("ok");
setBtnText("错了，再试一次",900);
}
};
</script>
</body>
</html>
