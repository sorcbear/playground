<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ppl</title>

<style>
:root{
  --c-blue:#0070c0;
  --c-cyan:#00b0f0;
  --c-green:#00b050;
  --c-lgreen:#92d050;
  --c-yellow:#ffff00;
  --c-orange:#ffc000;
  --c-red:#ff0000;
  --c-purple:#7030a0;

  --ok:#0b6b2b; /* ✅ 成功文字颜色（绿色系） */
}

body{
  margin:0;
  background:#fff;
  font-family:"Microsoft YaHei","PingFang SC","Noto Sans SC",sans-serif;
}

.wrap{
  max-width:980px;
  margin:0 auto;
  padding:20px;
}

.intro{
  font-size:18px;
  line-height:1.7;
  color:#111;
  margin:0 0 12px 0;
}

img{
  width:100%;
  display:block;
}

.code{
  margin-top:18px;
  display:flex;
  align-items:center;
  flex-wrap:wrap;
  gap:8px;
  font-size:18px;
}

.slot{
  height:46px;
  line-height:44px;
  border:2px solid #000;
  font-size:22px;
  font-weight:700;
  text-align:center;
  resize:none;
  outline:none;
  padding:0 6px;
  box-sizing:border-box;

  /* ✅ 光标改为黑色（更明显） */
  caret-color:#000;
}

.w1{ width:50px; }
.w2{ width:84px; }

textarea{ overflow:hidden; }

.rd{
  height:46px;
  width:60px;
  border:3px solid #c00000;
  color:#c00000;
  font-weight:900;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
}

.buttons{
  margin-top:20px;
  display:flex;
  gap:18px;
}

button{
  flex:1;
  height:64px;
  border-radius:32px;
  border:none;
  background:#111;
  color:#fff;
  font-size:22px;
  font-weight:700;
  cursor:pointer;
}

button:active{
  transform:scale(0.98);
}

/* ✅ 倒计时文字：14px，仍在 .msg 内显示 */
.msg{
  margin-top:14px;
  font-size:14px;
  font-weight:700;
}
.ok{ color:var(--ok); }
.fail{ color:#b00020; }
</style>
</head>

<body>
<div class="wrap">

  <p class="intro">
    原来是那一天，记得参加完签售会后，我去了衡山公园约会，那里有一个名人雕塑，或许有下一个谜题的线索。
  </p>

  <img src="puzzle.png" alt="puzzle">

  <div class="code">
    <div>请在方框内输入暗号：</div>

    <textarea id="s1" class="slot w1" style="background:var(--c-blue)"></textarea>
    <textarea id="s2" class="slot w2" style="background:var(--c-cyan)"></textarea>
    <textarea id="s3" class="slot w1" style="background:var(--c-green)"></textarea>
    <textarea id="s4" class="slot w2" style="background:var(--c-lgreen)"></textarea>

    <div class="rd">RD</div>

    <textarea id="s5" class="slot w1" style="background:var(--c-yellow)"></textarea>
    <textarea id="s6" class="slot w1" style="background:var(--c-orange)"></textarea>
    <textarea id="s7" class="slot w1" style="background:var(--c-red)"></textarea>
    <textarea id="s8" class="slot w1" style="background:var(--c-purple)"></textarea>
  </div>

  <div class="buttons">
    <button id="btnReset" onclick="resetAll()">Reset</button>
    <button id="btnSubmit" onclick="check()">Submit</button>
  </div>

  <div id="msg" class="msg"></div>
</div>

<script>
const ANSWER = ["四","君子","在","衡山","五","四","三","号"];
const ids = ["s1","s2","s3","s4","s5","s6","s7","s8"];

const NEXT_URL = "https://sorcbear.github.io/playground/riddle/";

let redirectTimer = null;
let ticking = false;

function clean(v){
  return v.replace(/\s/g,"");
}

function lockUI(locked){
  const btnReset = document.getElementById("btnReset");
  const btnSubmit = document.getElementById("btnSubmit");
  btnReset.disabled = locked;
  btnSubmit.disabled = locked;
}

function startCountdownAndGo(){
  const msg = document.getElementById("msg");
  ticking = true;
  lockUI(true);

  let n = 3;
  msg.textContent = `答案正确，即将进入下一题（${n}）`;
  msg.className = "msg ok"; // ✅ 使用 .msg.ok 绿色

  redirectTimer = setInterval(() => {
    n -= 1;
    if(n >= 1){
      msg.textContent = `答案正确，即将进入下一题（${n}）`;
    }else{
      clearInterval(redirectTimer);
      redirectTimer = null;
      location.href = NEXT_URL;
    }
  }, 1000);
}

function check(){
  if(ticking) return; // ✅ 防重复触发
  const ok = ids.every((id,i)=> clean(document.getElementById(id).value) === ANSWER[i]);
  const msg = document.getElementById("msg");

  if(ok){
    // ✅ 不再显示 "success"，改为倒计时流程并锁定交互
    startCountdownAndGo();
  }else{
    msg.textContent = "try again";
    msg.className = "msg fail";
  }
}

function resetAll(){
  if(ticking) return; // ✅ 倒计时期间锁定 Reset
  ids.forEach(id=>document.getElementById(id).value="");
  const msg = document.getElementById("msg");
  msg.textContent="";
  msg.className="msg";
}
</script>
</body>
</html>
