<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Barrel Puzzle</title>

<style>
:root{
  --bg:#ffffff;

  /* 外框与分隔线 */
  --outerLine:4px;
  --midLine:4px;
  --lineColor:#000000;
  --radius:18px;

  /* 数字样式（你说要小一点：可继续改这个） */
  --digitSize: 280px;
  --digitColor:#243B8F;
  --digitStroke:#0B0F2E;
  --digitStrokeW:7px;
  --digitShadow:0 5px 0 rgba(0,0,0,.14);

  /* 按钮尺寸与间距（可调） */
  --btnSize:76px;
  --btnGap:44px;
}

*{ box-sizing:border-box; }

html,body{
  margin:0;
  padding:0;
  background:var(--bg);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "PingFang SC", "Noto Sans CJK SC", "Microsoft YaHei", sans-serif;
}

/* 关闭移动端点击高亮（按钮不再闪一下） */
body{ -webkit-tap-highlight-color: transparent; }

.wrap{
  width:min(1200px, 94vw);
  margin:24px auto 18px;
  padding:0 10px;
}

/* ===== 三张卡拼成一体：用 flex 保证三等分 ===== */
.strip{
  position:relative;
  display:flex;
  border:var(--outerLine) solid var(--lineColor);
  border-radius:var(--radius);
  overflow:hidden;
  background:#fff;
}

.card{
  position:relative;
  flex: 1 1 0;
  background:#fff;
}

.pattern{
  display:block;
  width:100%;
  height:auto; /* 由图片自然比例决定高度，三张等宽 -> 底边必齐 */
  user-select:none;
  -webkit-user-drag:none;
  pointer-events:none;
}

/* 分隔线：覆盖绘制，不参与布局，避免高度不齐 */
.divider{
  position:absolute;
  top:0;
  bottom:0;
  width:var(--midLine);
  background:var(--lineColor);
  z-index:5;
  pointer-events:none;
}
.div1{ left: calc(33.333333% - (var(--midLine) / 2)); }
.div2{ left: calc(66.666666% - (var(--midLine) / 2)); }

/* 数字覆盖层 */
.digit{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%, -50%);

  font-family:"Cinzel","Times New Roman",Georgia,serif;
  font-size: var(--digitSize);
  line-height:1;
  color:var(--digitColor);

  -webkit-text-stroke: var(--digitStrokeW) var(--digitStroke);
  paint-order: stroke fill;

  text-shadow: var(--digitShadow);
  user-select:none;
}

/* 按钮区 */
.buttons{
  display:flex;
  justify-content:center;
  gap:var(--btnGap);
  margin-top:26px;
}

.coinBtn{
  width:var(--btnSize);
  height:var(--btnSize);
  border:none;
  background:transparent;
  padding:0;
  cursor:pointer;

  outline:none;
  -webkit-appearance:none;
  appearance:none;
  touch-action: manipulation;
}
.coinBtn:focus,
.coinBtn:focus-visible{ outline:none; }
.coinBtn:active{ transform:none; filter:none; }

.coinBtn img{
  width:100%;
  height:100%;
  display:block;
  user-select:none;
  -webkit-user-drag:none;
  pointer-events:none;
}

.status{
  text-align:center;
  margin-top:14px;
  min-height:22px;
  font-weight:600;
}

/* 手机适配：避免数字溢出 */
@media (max-width: 900px){
  :root{
    --digitSize: min(36vw, 260px);
    --btnSize:72px;
    --btnGap:38px;
    --outerLine:3px;
    --midLine:3px;
  }
}
</style>
</head>

<body>
<div class="wrap">

  <div class="strip">
    <div class="divider div1"></div>
    <div class="divider div2"></div>

    <div class="card">
      <img class="pattern" id="pat1" src="p0.png" alt="p0">
      <div class="digit" id="dig1">1</div>
    </div>

    <div class="card">
      <img class="pattern" id="pat2" src="p1.png" alt="p1">
      <div class="digit" id="dig2">1</div>
    </div>

    <div class="card">
      <img class="pattern" id="pat3" src="p2.png" alt="p2">
      <div class="digit" id="dig3">3</div>
    </div>
  </div>

  <div class="buttons">
    <button class="coinBtn" id="btn1" aria-label="按钮1"><img src="coin.png" alt="coin"></button>
    <button class="coinBtn" id="btn2" aria-label="按钮2"><img src="coin.png" alt="coin"></button>
    <button class="coinBtn" id="btn3" aria-label="按钮3"><img src="coin.png" alt="coin"></button>
  </div>

  <div class="status" id="status"></div>

</div>

<script>
/* ===== 只用 3 种图案 ===== */
const patterns = ["p0.png","p1.png","p2.png"];

/* ===== 状态：数字 1..9，图案 0..2 ===== */
let D = [1, 1, 3];   // D1, D2, D3
let P = [0, 1, 2];   // P1, P2, P3

/* ===== 目标（你可按关卡需要修改） ===== */
const targetD = [4, 7, 2];
const targetP = [0, 2, 1];

const digEls = [
  document.getElementById("dig1"),
  document.getElementById("dig2"),
  document.getElementById("dig3"),
];
const patEls = [
  document.getElementById("pat1"),
  document.getElementById("pat2"),
  document.getElementById("pat3"),
];

function incDigit(x){ return (x % 9) + 1; }
function incPattern(x){ return (x + 1) % patterns.length; }

/* ===== 规则（你确认的“一定有解、难度适中”版本）=====
按钮1：P1 +1，D2 +1
按钮2：P2 +1，D3 +1
按钮3：P3 +1，D1/D2/D3 都 +1
*/
function applyRule(k){
  if(k === 1){
    P[0] = incPattern(P[0]); // P1
    D[1] = incDigit(D[1]);   // D2
  }else if(k === 2){
    P[1] = incPattern(P[1]); // P2
    D[2] = incDigit(D[2]);   // D3
  }else if(k === 3){
    P[2] = incPattern(P[2]); // P3
    D[0] = incDigit(D[0]);
    D[1] = incDigit(D[1]);
    D[2] = incDigit(D[2]);
  }
}

function render(){
  for(let i=0;i<3;i++){
    digEls[i].textContent = String(D[i]);
    patEls[i].src = patterns[P[i]];
  }
  // 操作后如果你希望不清除 success，就注释下面两行
  // document.getElementById("status").textContent = "";
}

function checkWin(){
  for(let i=0;i<3;i++){
    if(D[i] !== targetD[i]) return;
    if(P[i] !== targetP[i]) return;
  }
  document.getElementById("status").textContent = "success";
}

document.getElementById("btn1").onclick = () => { applyRule(1); render(); checkWin(); };
document.getElementById("btn2").onclick = () => { applyRule(2); render(); checkWin(); };
document.getElementById("btn3").onclick = () => { applyRule(3); render(); checkWin(); };

/* 初次渲染 */
render();
</script>
</body>
</html>
