<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="format-detection" content="telephone=no,address=no,email=no">
<title>Number Puzzle</title>

<style>
/* ✅ 整块（含数字）都不可选中 */
.strip,
.strip *{
  user-select:none;
  -webkit-user-select:none;
  -webkit-touch-callout:none;
  -webkit-user-drag:none;
}
.green{
    color: #2E7D32;
  }
:root{
  /* ===== Rotate 同源 UI 基础 ===== */
  --maxw: 720px;

  --fs-body: 18px;
  --lh-body: 1.6;

  --fs-hint: 18px;
  --lh-hint: 1.6;

  --gap: 18px;
  --gap-tight: 12px;

  --bg:#ffffff;
  --c-text:#111;

  /* ===== Barrel 本题专用 ===== */
  --outerLine:4px;
  --midLine:4px;
  --lineColor:#000;
  --radius:18px;

  --digitSize:220px;
  --digitColor:#243B8F;
  --digitStroke:#0B0F2E;
  --digitStrokeW:6px;
  --digitShadow:none;

  --btnSize:76px;
  --btnGap:44px;

  --ok:#0b6b2b;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  margin:0;
  background:var(--bg);
  color:var(--c-text);

  /* ✅ Rotate 同款字体栈 */
  font-family: system-ui, -apple-system, "PingFang SC","Microsoft YaHei", Arial, sans-serif;

  /* ✅ Rotate 同款基准字号/行高 */
  font-size:var(--fs-body);
  line-height:var(--lh-body);

  /* ✅ Rotate 同款 */
  -webkit-text-size-adjust:100%;

  -webkit-tap-highlight-color: transparent;
}

/* ✅ Rotate 同源：外层间距 */
.wrap{
  max-width:var(--maxw);
  margin:0 auto;
  padding:18px 14px 28px;
}

/* ✅ 顶部提示：字号/行高/字重与 Rotate 标题一致（18 / 1.6 / 700） */
.topHint{
  margin:4px 0 var(--gap);
  font-size:var(--fs-hint);
  line-height:var(--lh-hint);
  font-weight:700;
  text-align:left;
  white-space:pre-wrap;
  color:#000;
}

/* ===== 三张拼成一体 ===== */
.strip{
  position:relative;
  display:flex;
  border:var(--outerLine) solid var(--lineColor);
  border-radius:var(--radius);
  overflow:hidden;
  background:#fff;
}

.card{
  position:relative;
  flex:1 1 0;
  background:#fff;
}

.pattern{
display:block;
width:100%;
height:auto;


/* ❌ 不可选中 / 不可复制 */
user-select:none;
-webkit-user-select:none;


/* ❌ 不可长按弹出菜单 */
-webkit-touch-callout:none;


/* ❌ 不参与任何指针事件 */
pointer-events:none;
}

/* 分隔线覆盖绘制，不参与布局 */
.divider{
  position:absolute;
  top:0; bottom:0;
  width:var(--midLine);
  background:var(--lineColor);
  pointer-events:none;
}
.div1{ left:33.3333%; transform:translateX(-50%); }
.div2{ left:66.6666%; transform:translateX(-50%); }

/* 数字 */
.digit{
position:absolute;
left:50%;
top:50%;
transform:translate(-50%,-50%);
font-family:"Cinzel","Times New Roman",serif;
font-size:var(--digitSize);
line-height:1;
color:var(--digitColor);
-webkit-text-stroke:var(--digitStrokeW) var(--digitStroke);
paint-order:stroke fill;
text-shadow:var(--digitShadow);


/* ✅ 核心三件套 */
user-select:none;
-webkit-user-select:none;
-webkit-touch-callout:none;


/* ❌ 不响应任何触摸/鼠标 */
pointer-events:none;
}

/* 按钮 */
.buttons{
  display:flex;
  justify-content:center;
  gap:var(--btnGap);
  margin-top:var(--gap); /* 同源间距 */
  -webkit-user-select:none;
  user-select:none;
  -webkit-touch-callout:none;
}

.coinBtn{
  width:var(--btnSize);
  height:var(--btnSize);
  border:none;
  background:none;
  padding:0;
  cursor:pointer;
  appearance:none;
  outline:none;
  touch-action: manipulation;
}
.coinBtn:focus,
.coinBtn:focus-visible{ outline:none; }
.coinBtn:active{ transform:none; filter:none; }

.coinBtn img{
  width:100%;
  height:100%;
  display:block;
  pointer-events:none;
  user-select:none;
}

/* 倒计时提示：同源间距 */
.msg{
  text-align:left;
  margin-top:var(--gap-tight);
  min-height:22px;
  font-size:14px;
  font-weight:700;
  color:#000;
}
.msg.ok{ color:var(--ok); }

/* 手机适配：只动图形尺寸，不动文字字号（保持与 Rotate 一致） */
@media (max-width:900px){
  :root{
    --digitSize:min(30vw,210px);
    --btnSize:72px;
    --btnGap:38px;
    --outerLine:3px;
    --midLine:3px;
  }
}
</style>
</head>

<body>
<div class="wrap">

  <div class="topHint">沿着<span class="green">“康平路”</span>方向前进，在100米的距离内留意墙面信息，找到线索。</div>

  <div class="strip">
    <div class="divider div1"></div>
    <div class="divider div2"></div>

    <div class="card">
      <img class="pattern" id="pat1" src="p0.png" alt="p0">
      <div class="digit" id="dig1">6</div>
    </div>

    <div class="card">
      <img class="pattern" id="pat2" src="p1.png" alt="p1">
      <div class="digit" id="dig2">6</div>
    </div>

    <div class="card">
      <img class="pattern" id="pat3" src="p2.png" alt="p2">
      <div class="digit" id="dig3">6</div>
    </div>
  </div>

  <div class="buttons">
    <button class="coinBtn" id="btn1" aria-label="按钮1"><img src="coin.png" alt="coin"></button>
    <button class="coinBtn" id="btn2" aria-label="按钮2"><img src="coin.png" alt="coin"></button>
    <button class="coinBtn" id="btn3" aria-label="按钮3"><img src="coin.png" alt="coin"></button>
  </div>

  <div class="msg" id="msg"></div>

</div>

<script>
/* ===== 资源 ===== */
const patterns = ["p0.png","p1.png","p2.png"]; // 3种图案

/* ===== 数字范围：0..6（7 个数字） ===== */
const DIGIT_MOD = 7;

/* ===== 跳转目标 ===== */
const NEXT_URL = "https://sorcbear.github.io/playground/post/";

/* ===== 当前状态 ===== */
let D = [6, 6, 6];   // 初始 666
let P = [0, 1, 2];   // P1 P2 P3  (0..2)

/* ===== 正确答案：全 p0 + 105 ===== */
const targetD = [1, 0, 5];
const targetP = [0, 0, 0];

/* ===== DOM ===== */
const digEls = [
  document.getElementById("dig1"),
  document.getElementById("dig2"),
  document.getElementById("dig3"),
];
const patEls = [
  document.getElementById("pat1"),
  document.getElementById("pat2"),
  document.getElementById("pat3"),
];
const msgEl = document.getElementById("msg");

const btn1 = document.getElementById("btn1");
const btn2 = document.getElementById("btn2");
const btn3 = document.getElementById("btn3");

/* ===== 交互锁定（倒计时期间禁止重复触发） ===== */
let isCountingDown = false;
function setButtonsLocked(locked){
  btn1.disabled = locked;
  btn2.disabled = locked;
  btn3.disabled = locked;
}

/* ===== 工具 ===== */
function incDigit(x){ return (x + 1) % DIGIT_MOD; }
function incPattern(x){ return (x + 1) % patterns.length; }

/* ===== 新规则（纠缠版）===== */
function applyRule(k){
  if(k === 1){
    D[0] = incDigit(D[0]);
    P[1] = incPattern(P[1]);
  }else if(k === 2){
    P[0] = incPattern(P[0]);
    D[1] = incDigit(D[1]);
    D[2] = incDigit(D[2]);
  }else if(k === 3){
    D[2] = incDigit(D[2]);
    P[2] = incPattern(P[2]);
  }
}

function checkWin(){
  for(let i=0;i<3;i++){
    if(D[i] !== targetD[i]) return false;
    if(P[i] !== targetP[i]) return false;
  }
  return true;
}

function render(){
  for(let i=0;i<3;i++){
    digEls[i].textContent = String(D[i]);
    patEls[i].src = patterns[P[i]];
  }

  if(!isCountingDown){
    msgEl.textContent = "";
    msgEl.classList.remove("ok");
  }

  if(checkWin()){
    startCountdownOnce();
  }
}

function startCountdownOnce(){
  if(isCountingDown) return;
  isCountingDown = true;

  setButtonsLocked(true);

  let t = 5;
  msgEl.classList.add("ok");
  msgEl.textContent = `答案正确，即将进入下一题（${t}）`;

  const timer = setInterval(() => {
    t -= 1;
    if(t >= 1){
      msgEl.textContent = `答案正确，即将进入下一题（${t}）`;
    }else{
      clearInterval(timer);
      location.href = NEXT_URL;
    }
  }, 1000);
}

btn1.onclick = () => { if(isCountingDown) return; applyRule(1); render(); };
btn2.onclick = () => { if(isCountingDown) return; applyRule(2); render(); };
btn3.onclick = () => { if(isCountingDown) return; applyRule(3); render(); };

render();
</script>
</body>
</html>
